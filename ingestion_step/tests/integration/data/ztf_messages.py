import pandas as pd

# Object Examples
existing_object_dict = {
    "oid": 525514836051,
    "tid": 0,
    "sid": 0,
    "meanra": 24.9727715,
    "meandec": 80.1261364,
    "sigmara": None,
    "sigmadec": None,
    "firstmjd": 58760.2800925998,
    "lastmjd": 58760.2800925998,
    "deltamjd": 0,
    "n_det": 1,
    "n_forced": 1,
    "n_non_det": 1,
    "corrected": False,
    "stellar": False,
}

existing_ztf_objects_expected = {
    "oid": 525514836051,
    "g_r_max": None,
    "g_r_max_corr": None,
    "g_r_mean": None,
    "g_r_mean_corr": None,
}

new_objects_dict = [
    {
        "oid": 525514836051,
        "tid": 0,
        "sid": 0,
        "ra": 24.9727713,
        "dec": 80.1261365,
        "mjd": 58791.2800925998,
    },
    {
        "oid": 390733221096,
        "tid": 0,
        "sid": 0,
        "ra": 43.3676758,
        "dec": 22.5319344,
        "mjd": 58791.28415510012,
    },
    {
        "oid": 755834527363,
        "tid": 0,
        "sid": 0,
        "ra": 23.5628347,
        "dec": 18.0653951,
        "mjd": 58791.27378469985,
    },
]

objects_expected = [
    {
        "oid": 525514836051,
        "tid": 0,
        "sid": 0,
        "meanra": 24.9727715,
        "meandec": 80.1261364,
        "sigmara": None,
        "sigmadec": None,
        "firstmjd": 58760.2800925998,
        "lastmjd": 58760.2800925998,
        "deltamjd": 0,
        "n_det": 1,
        "n_forced": 1,
        "n_non_det": 1,
        "corrected": False,
        "stellar": False,
    },
    {
        "oid": 390733221096,
        "tid": 0,
        "sid": 0,
        "meanra": 43.3676758,
        "meandec": 22.5319344,
        "sigmara": None,
        "sigmadec": None,
        "firstmjd": 58791.28415510012,
        "lastmjd": 58791.28415510012,
        "deltamjd": 0,
        "n_det": 1,
        "n_forced": 1,
        "n_non_det": 1,
        "corrected": False,
        "stellar": False,
    },
    {
        "oid": 755834527363,
        "tid": 0,
        "sid": 0,
        "meanra": 23.5628347,
        "meandec": 18.0653951,
        "sigmara": None,
        "sigmadec": None,
        "firstmjd": 58791.27378469985,
        "lastmjd": 58791.27378469985,
        "deltamjd": 0,
        "n_det": 1,
        "n_forced": 1,
        "n_non_det": 1,
        "corrected": False,
        "stellar": False,
    },
]

ztf_objects_expected = [
    {
        "oid": 525514836051,
        "g_r_max": None,
        "g_r_max_corr": None,
        "g_r_mean": None,
        "g_r_mean_corr": None,
    },
    {
        "oid": 390733221096,
        "g_r_max": None,
        "g_r_max_corr": None,
        "g_r_mean": None,
        "g_r_mean_corr": None,
    },
    {
        "oid": 755834527363,
        "g_r_max": None,
        "g_r_max_corr": None,
        "g_r_mean": None,
        "g_r_mean_corr": None,
    },
]

# dataframes
new_objects_df = pd.DataFrame(new_objects_dict)
new_objects_df = new_objects_df.set_index("oid")

# -------------------
# Detections Examples
# -------------------

existing_detections_dict = {
    "oid": 525514836051,
    "measurement_id": 6522020776,
    "mjd": 59823.18777780002,
    "ra": 24.9727715,
    "dec": 80.1261364,
    "band": 1,
}

existing_ztf_detections_dict = {
    "oid": 525514836051,
    "measurement_id": 6522020776,
    "pid": 0,
    "diffmaglim": 20.7186,
    "isdiffpos": -1,
    "nid": 2086,
    "magpsf": 18.6763,
    "sigmapsf": 0.256155,
    "magapfloat4": 18.9507,
    "sigmagap": 0.0978,
    "distnr": 0.390865,
    "rb": 0.42,
    "rbversion": "t17_f5_c3",
    "drb": 0,
    "drbversion": "version",
    "magapbig": 18.956,
    "sigmagapbig": 0.1184,
    "rfid": 37032169288390928264,
    "magpsf_corr": None,
    "sigmapsf_corr": None,
    "sigmapsf_corr_ext": None,
    "corrected": False,
    "dubious": False,
    "parent_candid": 2086204034815010000,
    "has_stamp": True,
}


# pendiente modificar valores dentro de los dict
new_detections_dict = [
    {
        "oid": 525514836051,
        "measurement_id": 2086152344815010007,
        "band": 1,
        "mjd": 58791.2800925998,
        "ra": 24.9727713,
        "dec": 80.1261365,
        "pid": 0,
        "diffmaglim": 20.7186,
        "isdiffpos": -1,
        "nid": 2086,
        "magpsf": 18.6763,
        "sigmapsf": 0.256155,
        "magapfloat4": 18.9507,
        "sigmagap": 0.0978,
        "distnr": 0.390865,
        "rb": 0.42,
        "rbversion": "t17_f5_c3",
        "drb": 0,
        "drbversion": "version",
        "magapbig": 18.956,
        "sigmagapbig": 0.1184,
        "rfid": 37032169288390928264,
        "parent_candid": 2086204034815010000,
    },
    {
        "oid": 525514836051,
        "measurement_id": 33901985509617371168,
        "band": 1,
        "mjd": 58791.28415510012,
        "ra": 43.3676758,
        "dec": 22.5319344,
        "pid": 0,
        "diffmaglim": 20.7186,
        "isdiffpos": -1,
        "nid": 2086,
        "magpsf": 18.6763,
        "sigmapsf": 0.256155,
        "magapfloat4": 18.9507,
        "sigmagap": 0.0978,
        "distnr": 0.390865,
        "rb": 0.42,
        "rbversion": "t17_f5_c3",
        "drb": 0,
        "drbversion": "version",
        "magapbig": 18.956,
        "sigmagapbig": 0.1184,
        "rfid": 37032169288390928264,
        "parent_candid": 31041140455606637741,
    },
    {
        "oid": 525514836051,
        "measurement_id": 11295855772185777722,
        "band": 1,
        "mjd": 58791.27378469985,
        "ra": 23.5628347,
        "dec": 18.0653951,
        "pid": 0,
        "diffmaglim": 20.7186,
        "isdiffpos": -1,
        "nid": 2086,
        "magpsf": 18.6763,
        "sigmapsf": 0.256155,
        "magapfloat4": 18.9507,
        "sigmagap": 0.0978,
        "distnr": 0.390865,
        "rb": 0.42,
        "rbversion": "t17_f5_c3",
        "drb": 0,
        "drbversion": "version",
        "magapbig": 18.956,
        "sigmagapbig": 0.1184,
        "rfid": 37032169288390928264,
        "parent_candid": 24855982039559546080,
    },
]

detections_expected = [
    {
        "oid": 525514836051,
        "measurement_id": 2086152344815010007,
        "mjd": 59823.18777780002,
        "ra": 24.9727715,
        "dec": 80.1261364,
        "band": 1,
    },
    {
        "oid": 390733221096,
        "measurement_id": 33901985509617371168,
        "mjd": 58791.28415510012,
        "ra": 43.3676758,
        "dec": 22.5319344,
        "band": 1,
    },
    {
        "oid": 755834527363,
        "measurement_id": 11295855772185777722,
        "mjd": 58791.27378469985,
        "ra": 23.5628347,
        "dec": 18.0653951,
        "band": 1,
    },
]

ztf_detections_expected = [
    {
        "oid": 525514836051,
        "measurement_id": 2086152344815010007,
        "pid": 0,
        "diffmaglim": 20.7186,
        "isdiffpos": -1,
        "nid": 2086,
        "magpsf": 18.6763,
        "sigmapsf": 0.256155,
        "magapfloat4": 18.9507,
        "sigmagap": 0.0978,
        "distnr": 0.390865,
        "rb": 0.42,
        "rbversion": "t17_f5_c3",
        "drb": 0,
        "drbversion": "version",
        "magapbig": 18.956,
        "sigmagapbig": 0.1184,
        "rfid": 37032169288390928264,
        "magpsf_corr": None,
        "sigmapsf_corr": None,
        "sigmapsf_corr_ext": None,
        "corrected": False,
        "dubious": False,
        "parent_candid": 2086204034815010000,
        "has_stamp": True,
    },
    {
        "oid": 390733221096,
        "measurement_id": 33901985509617371168,
        "pid": 0,
        "diffmaglim": 20.7186,
        "isdiffpos": -1,
        "nid": 2086,
        "magpsf": 18.6763,
        "sigmapsf": 0.256155,
        "magapfloat4": 18.9507,
        "sigmagap": 0.0978,
        "distnr": 0.390865,
        "rb": 0.42,
        "rbversion": "t17_f5_c3",
        "drb": 0,
        "drbversion": "version",
        "magapbig": 18.956,
        "sigmagapbig": 0.1184,
        "rfid": 37032169288390928264,
        "magpsf_corr": None,
        "sigmapsf_corr": None,
        "sigmapsf_corr_ext": None,
        "corrected": False,
        "dubious": False,
        "parent_candid": 31041140455606637741,
        "has_stamp": True,
    },
    {
        "oid": 755834527363,
        "measurement_id": 11295855772185777722,
        "pid": 0,
        "diffmaglim": 20.7186,
        "isdiffpos": -1,
        "nid": 2086,
        "magpsf": 18.6763,
        "sigmapsf": 0.256155,
        "magapfloat4": 18.9507,
        "sigmagap": 0.0978,
        "distnr": 0.390865,
        "rb": 0.42,
        "rbversion": "t17_f5_c3",
        "drb": 0,
        "drbversion": "version",
        "magapbig": 18.956,
        "sigmagapbig": 0.1184,
        "rfid": 37032169288390928264,
        "magpsf_corr": None,
        "sigmapsf_corr": None,
        "sigmapsf_corr_ext": None,
        "corrected": False,
        "dubious": False,
        "parent_candid": 24855982039559546080,
        "has_stamp": True,
    },
]

# dataframes
new_detections_df = pd.DataFrame(new_detections_dict)
new_detections_df = new_detections_df.set_index("oid")

# --------------------------
# Forced Photometry Examples
# --------------------------

existing_fp_dict = {
    "oid": 525514836051,
    "measurement_id": 6522020776,
    "mjd": 60754.49832180003,
    "ra": 256.4062549,
    "dec": 34.1939546,
    "band": 0,
}

existing_ztf_fp_dict = {
    "oid": 525514836051,
    "measurement_id": 30099884727062793723,
    "mag": 18.8348445892334,
    "e_mag": 0.036699023097753525,
    "mag_corr": None,
    "e_mag_corr": None,
    "e_mag_corr_ext": None,
    "isdiffpos": -1,
    "corrected": False,
    "dubious": False,
    "parent_candid": 623545309122114,
    "has_stamp": False,
    "field": 681,
    "rcid": 47,
    "rfid": 681120247,
    "sciinpseeing": 1.4270999431610107,
    "scibckgnd": 188.37600708007812,
    "scisigpix": 8.232540130615234,
    "magzpsci": 26.3262996673584,
    "magzpsciunc": 0.0000023943000542,
    "magzpscirms": 0.02357419952750206,
    "clrcoeff": 0.09974180161952972,
    "clrcounc": 0.0000052701298046,
    "exptime": 30,
    "adpctdif1": 0.06977400183677673,
    "adpctdif2": 0.09132999926805496,
    "diffmaglim": 20.46649932861328,
    "programid": 1,
    "procstatus": 0,
    "distnr": 2.9334888458251953,
    "ranr": 256.4052734375,
    "decnr": 34.19382095336914,
    "magnr": 18.472000122070312,
    "sigmagnr": 0.11599999666213989,
    "chinr": 6.926000118255615,
    "sharpnr": 0.4560000002384186,
}

new_fp_dict = [
    {
        "oid": 525514836051,
        "measurement_id": 30099884727062793723,
        "mjd": 58791.2800925998,
        "ra": 24.9727713,
        "dec": 80.1261365,
        "band": 0,
        "mag": 28.8348445892334,
        "e_mag": 0.036699023097753525,
        "parent_candid": 68926874613717,
        "field": 681,
        "rcid": 47,
        "rfid": 681120247,
        "sciinpseeing": 1.4270999431610107,
        "scibckgnd": 188.37600708007812,
        "scisigpix": 8.232540130615234,
        "magzpsci": 26.3262996673584,
        "magzpsciunc": 0.0000023943000542,
        "magzpscirms": 0.02357419952750206,
        "clrcoeff": 0.09974180161952972,
        "clrcounc": 0.0000052701298046,
        "exptime": 30,
        "adpctdif1": 0.06977400183677673,
        "adpctdif2": 0.09132999926805496,
        "diffmaglim": 20.46649932861328,
        "programid": 1,
        "procstatus": 0,
        "distnr": 2.9334888458251953,
        "ranr": 256.4052734375,
        "decnr": 34.19382095336914,
        "magnr": 18.472000122070312,
        "sigmagnr": 0.11599999666213989,
        "chinr": 6.926000118255615,
        "sharpnr": 0.4560000002384186,
    },
    {
        "oid": 525514836051,
        "measurement_id": 3390198550961737,
        "mjd": 58791.28415510012,
        "ra": 43.3676758,
        "dec": 22.5319344,
        "band": 0,
        "mag": 19.8348445892334,
        "e_mag": 0.036699023097753525,
        "parent_candid": 483820596279020,
        "field": 681,
        "rcid": 47,
        "rfid": 681120247,
        "sciinpseeing": 1.4270999431610107,
        "scibckgnd": 188.37600708007812,
        "scisigpix": 8.232540130615234,
        "magzpsci": 26.3262996673584,
        "magzpsciunc": 0.0000023943000542,
        "magzpscirms": 0.02357419952750206,
        "clrcoeff": 0.09974180161952972,
        "clrcounc": 0.0000052701298046,
        "exptime": 30,
        "adpctdif1": 0.06977400183677673,
        "adpctdif2": 0.09132999926805496,
        "diffmaglim": 20.46649932861328,
        "programid": 1,
        "procstatus": 0,
        "distnr": 2.9334888458251953,
        "ranr": 256.4052734375,
        "decnr": 34.19382095336914,
        "magnr": 18.472000122070312,
        "sigmagnr": 0.11599999666213989,
        "chinr": 6.926000118255615,
        "sharpnr": 0.4560000002384186,
    },
    {
        "oid": 525514836051,
        "measurement_id": 56084890829348561141,
        "mjd": 60754.49832180003,
        "ra": 256.4062549,
        "dec": 34.1939546,
        "band": 0,
        "mag": 18.8348445892334,
        "e_mag": 0.036699023097753525,
        "parent_candid": 470314498918075,
        "field": 681,
        "rcid": 47,
        "rfid": 681120247,
        "sciinpseeing": 1.4270999431610107,
        "scibckgnd": 188.37600708007812,
        "scisigpix": 8.232540130615234,
        "magzpsci": 26.3262996673584,
        "magzpsciunc": 0.0000023943000542,
        "magzpscirms": 0.02357419952750206,
        "clrcoeff": 0.09974180161952972,
        "clrcounc": 0.0000052701298046,
        "exptime": 30,
        "adpctdif1": 0.06977400183677673,
        "adpctdif2": 0.09132999926805496,
        "diffmaglim": 20.46649932861328,
        "programid": 1,
        "procstatus": 0,
        "distnr": 2.9334888458251953,
        "ranr": 256.4052734375,
        "decnr": 34.19382095336914,
        "magnr": 18.472000122070312,
        "sigmagnr": 0.11599999666213989,
        "chinr": 6.926000118255615,
        "sharpnr": 0.4560000002384186,
    },
]

fp_expected = [
    {
        "oid": 525514836051,
        "measurement_id": 67052171037979992019,
        "mjd": 60754.49832180003,
        "ra": 256.4062549,
        "dec": 34.1939546,
        "band": 0,
    },
    {
        "oid": 390733221096,
        "measurement_id": 33901985509617371168,
        "mjd": 58791.28415510012,
        "ra": 43.3676758,
        "dec": 22.5319344,
        "band": 0,
    },
    {
        "oid": 525514836051,
        "measurement_id": 30099884727062793723,
        "mjd": 60754.49832180003,
        "ra": 256.4062549,
        "dec": 34.1939546,
        "band": 0,
    },
]

ztf_fp_expected = [
    {
        "oid": 525514836051,
        "measurement_id": 30099884727062793723,
        "mag": 18.8348445892334,
        "e_mag": 0.036699023097753525,
        "mag_corr": None,
        "e_mag_corr": None,
        "e_mag_corr_ext": None,
        "isdiffpos": -1,
        "corrected": False,
        "dubious": False,
        "parent_candid": 62354530912211407461,
        "has_stamp": False,
        "field": 681,
        "rcid": 47,
        "rfid": 681120247,
        "sciinpseeing": 1.4270999431610107,
        "scibckgnd": 188.37600708007812,
        "scisigpix": 8.232540130615234,
        "magzpsci": 26.3262996673584,
        "magzpsciunc": 0.0000023943000542,
        "magzpscirms": 0.02357419952750206,
        "clrcoeff": 0.09974180161952972,
        "clrcounc": 0.0000052701298046,
        "exptime": 30,
        "adpctdif1": 0.06977400183677673,
        "adpctdif2": 0.09132999926805496,
        "diffmaglim": 20.46649932861328,
        "programid": 1,
        "procstatus": 0,
        "distnr": 2.9334888458251953,
        "ranr": 256.4052734375,
        "decnr": 34.19382095336914,
        "magnr": 18.472000122070312,
        "sigmagnr": 0.11599999666213989,
        "chinr": 6.926000118255615,
        "sharpnr": 0.4560000002384186,
    },
    {
        "oid": 390733221096,
        "measurement_id": 33901985509617371168,
        "mag": 18.8348445892334,
        "e_mag": 0.036699023097753525,
        "mag_corr": None,
        "e_mag_corr": None,
        "e_mag_corr_ext": None,
        "isdiffpos": -1,
        "corrected": False,
        "dubious": False,
        "parent_candid": 48382059627902604200,
        "has_stamp": False,
        "field": 681,
        "rcid": 47,
        "rfid": 681120247,
        "sciinpseeing": 1.4270999431610107,
        "scibckgnd": 188.37600708007812,
        "scisigpix": 8.232540130615234,
        "magzpsci": 26.3262996673584,
        "magzpsciunc": 0.0000023943000542,
        "magzpscirms": 0.02357419952750206,
        "clrcoeff": 0.09974180161952972,
        "clrcounc": 0.0000052701298046,
        "exptime": 30,
        "adpctdif1": 0.06977400183677673,
        "adpctdif2": 0.09132999926805496,
        "diffmaglim": 20.46649932861328,
        "programid": 1,
        "procstatus": 0,
        "distnr": 2.9334888458251953,
        "ranr": 256.4052734375,
        "decnr": 34.19382095336914,
        "magnr": 18.472000122070312,
        "sigmagnr": 0.11599999666213989,
        "chinr": 6.926000118255615,
        "sharpnr": 0.4560000002384186,
    },
    {
        "oid": 755834527363,
        "measurement_id": 56084890829348561141,
        "mag": 18.8348445892334,
        "e_mag": 0.036699023097753525,
        "mag_corr": None,
        "e_mag_corr": None,
        "e_mag_corr_ext": None,
        "isdiffpos": -1,
        "corrected": False,
        "dubious": False,
        "parent_candid": 47031449891807530603,
        "has_stamp": False,
        "field": 681,
        "rcid": 47,
        "rfid": 681120247,
        "sciinpseeing": 1.4270999431610107,
        "scibckgnd": 188.37600708007812,
        "scisigpix": 8.232540130615234,
        "magzpsci": 26.3262996673584,
        "magzpsciunc": 0.0000023943000542,
        "magzpscirms": 0.02357419952750206,
        "clrcoeff": 0.09974180161952972,
        "clrcounc": 0.0000052701298046,
        "exptime": 30,
        "adpctdif1": 0.06977400183677673,
        "adpctdif2": 0.09132999926805496,
        "diffmaglim": 20.46649932861328,
        "programid": 1,
        "procstatus": 0,
        "distnr": 2.9334888458251953,
        "ranr": 256.4052734375,
        "decnr": 34.19382095336914,
        "magnr": 18.472000122070312,
        "sigmagnr": 0.11599999666213989,
        "chinr": 6.926000118255615,
        "sharpnr": 0.4560000002384186,
    },
]

# dataframes
new_fp_df = pd.DataFrame(new_fp_dict)
new_fp_df = new_fp_df.set_index("oid")

# -----------------------
# Non Detections Examples
# -----------------------

existing_non_detections_dict = {
    "oid": 525514836051,
    "band": 0,
    "mjd": 60461.40795140015,
    "diffmaglim": 20.5782,
}

new_non_detections_dict = [
    {
        "oid": 525514836051,
        "band": 0,
        "mjd": 60461.40795140015,
        "diffmaglim": 27.5782,
    },
    {
        "oid": 525514836051,
        "band": 0,
        "mjd": 60462.40795140015,
        "diffmaglim": 22.5782,
    },
    {
        "oid": 525514836051,
        "band": 0,
        "mjd": 60463.40795140015,
        "diffmaglim": 23.5782,
    },
]

non_detections_expected = [
    {
        "oid": 525514836051,
        "band": 0,
        "mjd": 60461.40795140015,
        "diffmaglim": 20.5782,
    },
    {
        "oid": 525514836051,
        "band": 0,
        "mjd": 60462.40795140015,
        "diffmaglim": 22.5782,
    },
    {
        "oid": 525514836051,
        "band": 0,
        "mjd": 60463.40795140015,
        "diffmaglim": 23.5782,
    },
]

# dataframes
new_non_detections_df = pd.DataFrame(new_non_detections_dict)
new_non_detections_df = new_non_detections_df.set_index("oid")
